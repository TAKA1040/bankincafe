# bankincafe - 今後の予定

## 直近の作業予定

### 最優先: データ入れ替え作業
- [ ] 新しいCSVデータの受領（6000行）
- [ ] データ形式の確認・変換スクリプト作成
- [ ] 既存データのバックアップ
- [ ] invoices / invoice_line_items テーブルへのインポート（セットで総入れ替え）
- [ ] データ検証（件数・整合性チェック）

### 優先度高: UIとDBのマッピング修正
- [ ] 請求書一覧ページ（invoice-list）のカラムマッピング確認・修正
- [ ] 請求書詳細ページのカラムマッピング確認・修正
- [ ] 請求書作成ページのカラムマッピング確認・修正
- [ ] 売上管理ページのカラムマッピング確認・修正
- [ ] 作業検索ページのカラムマッピング確認・修正

---

## 現状の問題点

### データ品質問題
1. 請求書2,217件に対して明細79件 - 通常ありえない比率
2. 明細データの作業辞書連携不完全 - action, target, positionが多数空
3. 古いデータのみ - 2023年9月以降のデータなし

### UIとDBの不一致問題
- 画面の項目とDBカラムが一致していない箇所がある
- データ入れ替え後に要修正

---

## 不足機能一覧（請求書システムとして）

### 入金管理（重要度: 高）※現在未実装
- [ ] 入金登録機能 - invoice_paymentsテーブルは空
- [ ] 入金履歴一覧
- [ ] 未入金一覧・督促管理
- [ ] 入金消込機能

### 請求書編集（重要度: 高）
- [ ] 既存請求書の編集機能 - 作成後の修正
- [ ] 請求書のコピー作成
- [ ] 下書き保存・再開

### 赤伝・修正（重要度: 中）
- [ ] 赤伝（クレジットノート）発行 - DBにはinvoice_typeあり
- [ ] 修正請求書の発行

### レポート・集計（重要度: 中）
- [ ] 請求書発行履歴
- [ ] 顧客別売上レポート
- [ ] 期間指定レポート出力（CSV/Excel）
- [ ] 未払い請求書レポート

### 通知・連携（重要度: 低〜中）
- [ ] メール送信機能 - 請求書のメール送付
- [ ] 支払期限リマインダー

### データ管理（重要度: 中）
- [ ] CSVインポート機能（UI経由）
- [ ] CSVエクスポート機能
- [ ] データバックアップ機能

---

## 機能開発予定

### 作業辞書システム
- [ ] targets/actions/positions マスターの整備
- [ ] 作業辞書検索の最適化
- [ ] 明細データとマスターの関連付け

### 売上管理
- [ ] 売上管理ページの機能確認
- [ ] 月別・顧客別レポート機能

---

## 完了済み機能

### 請求書一覧ページ
- ページネーション機能（10/30/50件表示切り替え）
- 曖昧検索機能（ひらがな/カタカナ、大小文字、全角半角区別なし）
- 統計ダッシュボード
- 6列テーブルレイアウト
- 作業タイプ識別（T:個別、S:セット）

### ESLintチェック（2025-12-09）
- 5件のWarning（react-hooks/exhaustive-deps）- エラーなし

---

## メモ

### データインポート手順（予定）
1. CSVファイルの形式確認
2. 変換スクリプト作成（必要に応じて）
3. Supabase SQL Editorで既存データ削除（バックアップ後）
4. 新データのインポート
5. 件数・整合性検証

### 重要ファイル
- DATABASE_SCHEMA.md - テーブル構造詳細
- docs/invoice-list-features.md - 機能説明書

---

最終更新: 2025-12-10
